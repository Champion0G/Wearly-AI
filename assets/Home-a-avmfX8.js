import{j as e}from"./index-cPf8uUct.js";import{b as a,u as i}from"./vendor-CY12d32z.js";const t="wearly_products_cache",s=3e5,r=10485760,o=()=>{try{const e=localStorage.getItem(t);if(!e)return null;const{data:a,timestamp:i}=JSON.parse(e);return Date.now()-i>s?(localStorage.removeItem(t),null):a}catch(e){return console.error("Error reading cache:",e),null}},l=e=>{try{const a={data:e,timestamp:Date.now()};if(JSON.stringify(a).length>r)return console.warn("Cache size exceeds limit, clearing cache"),void localStorage.removeItem(t);localStorage.setItem(t,JSON.stringify(a))}catch(a){console.error("Error writing to cache:",a)}},c=[{id:"1001",name:"Classic Cotton T-Shirt",price:19.99,image:"https://images.unsplash.com/photo-1523381210434-271e8be1f52b?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80",category:"T-Shirts",description:"A comfortable cotton t-shirt perfect for everyday wear.",sizes:[{name:"S",availability:"in_stock"},{name:"M",availability:"in_stock"},{name:"L",availability:"in_stock"}]},{id:"1002",name:"Slim Fit Jeans",price:39.99,image:"https://images.unsplash.com/photo-1541099649105-f69ad21f3246?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80",category:"Jeans",description:"Modern slim fit jeans with a stylish wash.",sizes:[{name:"30",availability:"in_stock"},{name:"32",availability:"in_stock"},{name:"34",availability:"in_stock"}]},{id:"1003",name:"Casual Hoodie",price:44.99,image:"https://images.unsplash.com/photo-1556821840-3a63f95609a7?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&q=80",category:"Hoodies",description:"A warm and cozy hoodie perfect for chilly days.",sizes:[{name:"S",availability:"in_stock"},{name:"M",availability:"in_stock"},{name:"L",availability:"in_stock"},{name:"XL",availability:"in_stock"}]}];function n(){const[t,s]=a.useState([]),[r,n]=a.useState(!0),[d,m]=a.useState(null),[u,h]=a.useState(0),[p,g]=a.useState(!0),f=i(),v=a.useCallback((async e=>{const a=o();if(a&&0===e)return s(a),void n(!1);const i={method:"GET",headers:{"X-RapidAPI-Key":"79f78136ffmsh2587f6e96e44266p1dddc5jsne1f773947bac","X-RapidAPI-Host":"apidojo-hm-hennes-mauritz-v1.p.rapidapi.com"}};try{const a=await fetch(`https://apidojo-hm-hennes-mauritz-v1.p.rapidapi.com/products/list?country=us&lang=en&currentpage=${e}&pagesize=12&categories=men_all&concepts=H%26M%20MAN`,i);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const t=await a.json();if(t.results&&t.results.length>0){const a=t.results.map((e=>{var a,i,t,s,r,o,l,c,n,d,m;return{id:(null==(a=e.defaultArticle)?void 0:a.code)||e.code,name:e.name,price:(null==(i=e.price)?void 0:i.value)||0,image:(null==(o=null==(r=null==(s=null==(t=e.articles)?void 0:t[0])?void 0:s.images)?void 0:r[0])?void 0:o.url)||(null==(c=null==(l=e.galleryImages)?void 0:l[0])?void 0:c.url)||(null==(d=null==(n=e.images)?void 0:n[0])?void 0:d.url)||"https://via.placeholder.com/300x400?text=No+Image",category:e.categoryName,description:e.description||"",sizes:(null==(m=e.variantSizes)?void 0:m.map((e=>({name:e.filterCode||e.name,availability:e.availability||"in_stock"}))))||[]}}));0===e?(l(a),s(a)):s((e=>[...e,...a])),g(12===t.results.length)}else g(!1)}catch(t){if(console.error("Error fetching products:",t),m(t.message),0===e){const e=o();s(e||c)}}finally{n(!1)}}),[]);a.useEffect((()=>{v(u)}),[u,v]);const x=a.useCallback((()=>{window.innerHeight+document.documentElement.scrollTop===document.documentElement.offsetHeight&&!r&&p&&h((e=>e+1))}),[r,p]);return a.useEffect((()=>(window.addEventListener("scroll",x),()=>window.removeEventListener("scroll",x))),[x]),r&&0===t.length?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loader"}),e.jsx("p",{children:"Loading amazing products..."})]}):d&&!t.length?e.jsx("div",{className:"error-message",children:d}):e.jsxs("div",{className:"home",children:[e.jsxs("div",{className:"hero-section",children:[e.jsx("h1",{children:"Welcome to WEARLY"}),e.jsx("p",{className:"tagline",children:"Buy before you try"})]}),e.jsxs("div",{className:"products-section",children:[e.jsx("h2",{children:"Featured Products"}),d&&e.jsx("div",{className:"error-banner",children:"Unable to refresh products. Showing cached data."}),e.jsx("div",{className:"products-grid",children:t.map((a=>e.jsxs("div",{className:"product-card",onClick:()=>(e=>{f(`/product/${e.id}`,{state:{product:{id:e.id,name:e.name,price:e.price,image:e.image,images:[e.image],description:e.description||"No description available",category:e.category,sizes:e.sizes||[],details:[],care:[]}}})})(a),children:[e.jsxs("div",{className:"product-image",children:[e.jsx("img",{src:a.image,alt:a.name,loading:"lazy",onError:e=>{e.target.onerror=null,e.target.src="https://via.placeholder.com/300x400?text=No+Image"}}),e.jsx("div",{className:"hover-overlay",children:e.jsx("button",{className:"view-button",children:"View Details"})})]}),e.jsxs("div",{className:"product-details",children:[e.jsx("h3",{children:a.name}),e.jsx("p",{className:"category",children:a.category}),e.jsxs("p",{className:"price",children:["$",a.price]})]})]},a.id)))}),r&&t.length>0&&e.jsxs("div",{className:"loading-more",children:[e.jsx("div",{className:"loader"}),e.jsx("p",{children:"Loading more products..."})]})]})]})}export{n as default};
